<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>è¯¾ç¨‹æ•°æ®è§£æå™¨</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script>
  tailwind.config = {
    theme: {
      extend: {
        colors: {
          primary: '#3b82f6',
          secondary: '#64748b',
          accent: '#10b981',
          neutral: '#f1f5f9',
          dark: '#1e293b'
        },
        fontFamily: {
          sans: ['Inter', 'system-ui', 'sans-serif'],
        },
      },
    }
  }
</script>
<style type="text/tailwindcss">
  @layer utilities {
    .content-auto {
      content-visibility: auto;
    }
    .card-shadow {
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }
    .btn-hover {
      transition: all 0.3s ease;
    }
    .btn-hover:hover {
      transform: translateY(-2px);
    }
  }
</style>
</head>
<body class="bg-gray-50 font-sans text-dark">
  <div class="container mx-auto px-4 py-8 max-w-5xl">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <header class="text-center mb-10">
      <h1 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold text-primary mb-2">è¯¾ç¨‹æ•°æ®è§£æå™¨</h1>
      <p class="text-secondary">å°†ä¸‰è¡Œä¸€ç»„çš„è¯¾ç¨‹æ•°æ®è½¬æ¢ä¸ºå¢å¼ºåŠ©æ‰‹ä½¿ç”¨çš„ JSON æ ¼å¼</p>
    </header>
    <div class="bg-blue-50 border-l-4 border-primary p-4 mb-6 rounded-r-lg">
      <h3 class="text-lg font-semibold text-primary mb-2">ğŸ“‹ ä½¿ç”¨è¯´æ˜</h3>
      <ul class="text-secondary space-y-1 text-sm">
        <li>â€¢ é€‚ç”¨äºå¤„ç†å—ç†å·¥æ•™åŠ¡å¤„å‘å¸ƒçš„<a href="https://jwc.njust.edu.cn/b1/7f/c1189a307583/page.htm" target="_blank" class="text-primary hover:underline">é€šè¯†æ•™è‚²é€‰ä¿®è¯¾åˆ†ç±»æ±‡æ€»ï¼ˆ2022 ç‰ˆï¼‰</a>é¡µé¢çš„è¯¾ç¨‹æ•°æ®</li>
        <li>â€¢ ç›´æ¥ä»æ•™åŠ¡ç³»ç»Ÿè¡¨æ ¼å¤åˆ¶æ•°æ®ï¼Œç²˜è´´åˆ°è¾“å…¥æ¡†å³å¯è‡ªåŠ¨è§£æ</li>
        <li>â€¢ æ•°æ®æ ¼å¼ï¼šæ¯ 3 è¡Œä¸ºä¸€ç»„ï¼ˆè¯¾ç¨‹å·ã€è¯¾ç¨‹åã€ç±»åˆ«ï¼‰æ— é¡»äººä¸ºå¤„ç†ç©ºè¡Œ</li>
        <li>â€¢ å¯¼å‡ºçš„ JSON æ–‡ä»¶å¯æ›¿æ¢ enhance.js ä¸­çš„ xxk.jsonï¼Œä»¥é€‚é…æ–°ç‰ˆæ•™å­¦å¤§çº²ï¼ˆå¦‚æœ‰ï¼‰çš„é€‰ä¿®è¯¾ç±»åˆ«</li>
      </ul>
    </div>
    <!-- ä¸»å†…å®¹å¡ç‰‡ -->
    <div class="bg-white rounded-xl card-shadow p-6 mb-8 transition-all duration-300 hover:shadow-lg">
      <div class="mb-4">
        <h2 class="text-xl font-semibold mb-3 text-dark flex items-center">
          <i class="fa fa-info-circle text-primary mr-2"></i>æ•°æ®è¾“å…¥
        </h2>
        <p class="text-secondary text-sm mb-3">è¯·è¾“å…¥è¯¾ç¨‹æ•°æ®ï¼Œæ¯3è¡Œä¸ºä¸€ç»„ï¼ˆè¯¾ç¨‹å·ï¼Œè¯¾ç¨‹åï¼Œç±»åˆ«ï¼‰ æ— é¡»äººå·¥å¤„ç†ç©ºè¡Œ</p>
        <textarea 
          id="inputData" 
          class="w-full h-40 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all resize-none font-mono text-sm"
          placeholder="ä¾‹å¦‚ï¼š
è¯¾ç¨‹å·1
è¯¾ç¨‹å1
ç±»åˆ«1

è¯¾ç¨‹å·2

è¯¾ç¨‹å2
ç±»åˆ«2"
        ></textarea>
      </div>

      <!-- æŒ‰é’®åŒºåŸŸ -->
      <div class="flex flex-wrap gap-3 mt-4">
        <button 
          onclick="parseCourses()" 
          class="bg-primary text-white px-5 py-2 rounded-lg flex items-center btn-hover card-shadow"
        >
          <i class="fa fa-magic mr-2"></i>è§£æä¸ºJSON
        </button>
        <button 
          id="downloadBtn" 
          onclick="downloadJson()" 
          class="bg-accent text-white px-5 py-2 rounded-lg flex items-center btn-hover card-shadow opacity-50 cursor-not-allowed"
          disabled
        >
          <i class="fa fa-download mr-2"></i>ä¸‹è½½JSON
        </button>
        <button 
          onclick="clearAll()" 
          class="bg-gray-200 text-secondary px-5 py-2 rounded-lg flex items-center btn-hover"
        >
          <i class="fa fa-trash mr-2"></i>æ¸…ç©ºå†…å®¹
        </button>
      </div>
    </div>

    <!-- ç»“æœå±•ç¤ºåŒºåŸŸ -->
    <div class="bg-white rounded-xl card-shadow p-6 transition-all duration-300 hover:shadow-lg">
      <h2 class="text-xl font-semibold mb-3 text-dark flex items-center">
        <i class="fa fa-code text-primary mr-2"></i>è§£æç»“æœ
      </h2>
      <div class="relative">
        <pre id="outputJson" class="bg-neutral p-4 rounded-lg overflow-x-auto max-h-96 text-sm font-mono"></pre>
        <div id="emptyResult" class="absolute inset-0 flex items-center justify-center text-secondary">
          è§£æç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ
        </div>
      </div>
    </div>

    <!-- é¡µè„š -->
    <footer class="mt-10 pt-6 border-t border-gray-200">
      <div class="text-center text-secondary text-sm space-y-2">
        <p class="font-medium">NJUST-JWC-Enhance è¯¾ç¨‹æ•°æ®è§£æå™¨</p>
        <p>&copy; 2024 NJUST.WIKI. All rights reserved.</p>
        <p class="text-xs">
          <a href="https://njust.wiki/" class="text-primary hover:underline">é¡¹ç›®ä¸»é¡µ</a> |
          <a href="https://github.com/NJUST-OpenLib/NJUST-JWC-Enhance" class="text-primary hover:underline">GitHub</a> |
          <a href="index.html" class="text-primary hover:underline">å·¥å…·é›†</a>
        </p>
        <p class="text-xs text-gray-400">Made with â¤ï¸ by Light</p>
      </div>
    </footer>
  </div>

  <script>
    // è§£æè¯¾ç¨‹æ•°æ®ä¸ºJSON
    function parseCourses() {
      const input = document.getElementById('inputData').value.trim();
      const outputElement = document.getElementById('outputJson');
      const emptyResult = document.getElementById('emptyResult');
      const downloadBtn = document.getElementById('downloadBtn');

      if (!input) {
        showNotification('è¯·è¾“å…¥è¯¾ç¨‹æ•°æ®', 'warning');
        return;
      }

      // å¤„ç†è¾“å…¥æ•°æ®
      const lines = input.split('\n')
        .map(line => line.trim())
        .filter(line => line !== '');

      const courses = [];
      let hasWarning = false;

      for (let i = 0; i < lines.length; i += 3) {
        if (i + 2 < lines.length) {
          const course_code = lines[i];
          const course_name = lines[i + 1];
          const category = lines[i + 2];
          courses.push({ course_code, course_name, category });
        } else {
          hasWarning = true;
        }
      }

      // æ˜¾ç¤ºç»“æœ
      const jsonResult = JSON.stringify(courses, null, 2);
      outputElement.textContent = jsonResult;
      emptyResult.style.display = 'none';
      
      // å¯ç”¨ä¸‹è½½æŒ‰é’®
      downloadBtn.disabled = false;
      downloadBtn.classList.remove('opacity-50', 'cursor-not-allowed');
      
      // æ˜¾ç¤ºé€šçŸ¥
      showNotification(`æˆåŠŸè§£æ ${courses.length} æ¡è¯¾ç¨‹æ•°æ®`, 'success');
      
      // å¦‚æœæœ‰ä¸å®Œæ•´æ•°æ®ï¼Œæ˜¾ç¤ºè­¦å‘Š
      if (hasWarning) {
        showNotification('è­¦å‘Šï¼šæ•°æ®è¡Œæ•°ä¸æ˜¯3çš„å€æ•°ï¼Œæœ€åéƒ¨åˆ†æ•°æ®å·²å¿½ç•¥', 'warning');
      }
    }

    // ä¸‹è½½JSONæ–‡ä»¶
    function downloadJson() {
      const jsonData = document.getElementById('outputJson').textContent;
      
      if (!jsonData) {
        showNotification('æ²¡æœ‰å¯ä¸‹è½½çš„è§£æç»“æœ', 'warning');
        return;
      }
      
      // åˆ›å»ºBlobå¯¹è±¡
      const blob = new Blob([jsonData], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      
      // åˆ›å»ºä¸‹è½½é“¾æ¥
      const a = document.createElement('a');
      a.href = url;
      a.download = 'course_data_' + new Date().getTime() + '.json';
      document.body.appendChild(a);
      a.click();
      
      // æ¸…ç†
      setTimeout(() => {
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }, 0);
      
      showNotification('JSONæ–‡ä»¶å·²ä¸‹è½½', 'success');
    }

    // æ¸…ç©ºæ‰€æœ‰å†…å®¹
    function clearAll() {
      document.getElementById('inputData').value = '';
      document.getElementById('outputJson').textContent = '';
      document.getElementById('emptyResult').style.display = 'flex';
      
      const downloadBtn = document.getElementById('downloadBtn');
      downloadBtn.disabled = true;
      downloadBtn.classList.add('opacity-50', 'cursor-not-allowed');
    }

    // æ˜¾ç¤ºé€šçŸ¥æ¶ˆæ¯
    function showNotification(message, type = 'info') {
      // åˆ›å»ºé€šçŸ¥å…ƒç´ 
      const notification = document.createElement('div');
      
      // è®¾ç½®æ ·å¼å’Œå›¾æ ‡
      let bgColor, icon;
      switch(type) {
        case 'success':
          bgColor = 'bg-accent';
          icon = 'fa-check-circle';
          break;
        case 'warning':
          bgColor = 'bg-amber-500';
          icon = 'fa-exclamation-triangle';
          break;
        default:
          bgColor = 'bg-primary';
          icon = 'fa-info-circle';
      }
      
      notification.className = `${bgColor} text-white px-4 py-3 rounded-lg fixed bottom-4 right-4 flex items-center card-shadow z-50 transform translate-y-20 opacity-0 transition-all duration-300`;
      notification.innerHTML = `<i class="fa ${icon} mr-2"></i> ${message}`;
      
      // æ·»åŠ åˆ°é¡µé¢
      document.body.appendChild(notification);
      
      // æ˜¾ç¤ºé€šçŸ¥
      setTimeout(() => {
        notification.classList.remove('translate-y-20', 'opacity-0');
      }, 10);
      
      // è‡ªåŠ¨éšè—
      setTimeout(() => {
        notification.classList.add('translate-y-20', 'opacity-0');
        setTimeout(() => {
          document.body.removeChild(notification);
        }, 300);
      }, 3000);
    }
  </script>
</body>
</html>
